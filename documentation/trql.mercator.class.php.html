<style>
.trql_documentor_DocumentorSourceFile { margin: 1em 1em; padding: 1em; border: 1px solid #000; box-sizing: border-box; }
.trql_documentor_DocumentorSourceFile * { box-sizing: border-box; }
.trql_documentor_DocumentorSourceFile hr { border-top: 4px solid #800 !important; margin:2em 0; box-shadow: 0 6px 10px 1px rgba(0,0,0,.2); }
.trql_documentor_DocumentorSourceFile pre { background: #c001; }
.trql_documentor_DocumentorSourceFile pre strong { color: #b00; }
.DocumentorLabel { font-style: italic; display: block; margin-top:1em; }
.property { font-weight: bold;}
.shadow { box-shadow: 0 20px 15px -15px rgba(0,0,0,.5); }
.constrained { max-width: 100%; height: auto; }
.center { text-align:center; }
code,samp, .filename {color: #800 !important;
   font-family: Consolas,"courier new";
   background: rgba(240, 240, 240, 0.5);
   border: 1px solid silver;
   border-radius: 3px;
   padding: 0px 5px; }
.seealso code a {text-decoration:none;
   color: #800 !important;
   font-weight: bold;
   font-style: italic;
   }
.property.inheritance code { border: none !important; }
.assert.success { border: 2px solid green; padding: 5px; border-radius:3px; }
.assert.failure { border: 2px solid red; padding: 5px; border-radius:3px; }
.assert.success code, .assert.failure code { border: none !important; }
.DocumentorLabel { font-style: italic; display: block;}
section.class { margin: 1em 1em; padding: 1em; border: 1px solid #000; background: #eee9; }
img.vaesoli-image { border:1px solid silver; padding: 1em; display: block;}
table.properties { border:1px solid silver; border-collapse: collapse; width:100%; }
table.properties thead th { border:1px solid silver;padding: .5em; width:20%; }
table.properties thead th.description { width:60%; }
table.properties tr.property td,
table.properties tr.parameter td { border:1px solid silver;padding: .5em; width:20%; }
table.properties tr.property td.description,
table.properties tr.parameter td.description { width: 60%; }
p.property.func { font: .9em/1em lucida,georgia,"times new roman",serif;
   letter-spacing: 3px;
   width: 100%;
   margin: 0 0 15px 0;
   padding: 5px;
   color: rgb(255,128,0);
   padding: 1em;
   border: 1px solid #999;
   box-shadow: 0 0 5px 5px rgb(200 200 200 / 30%);
   border: 1px solid #888; }
</style>

<div class="trql_documentor_DocumentorSourceFile">
<section class="header">
<span class="DocumentorLabel">Filename: </span><span class="property filename">trql.mercator.class.php</span>
<span class="DocumentorLabel">Namespace: </span><span class="property namespace"><code>trql\quitus</code></span>
<span class="DocumentorLabel">Class aliases: </span><span class="property aliases"><code>\trql\quitus\Mother as Mother,\trql\quitus\iContext as iContext,\trql\vaesoli\Vaesoli as Vaesoli,\trql\utility\Utility as Utility,DOMDocument; use DOMXPath; if ( ! defined( 'MOTHER_ABSTRACT_CLASS' ) ) require_once( 'trql.mother.cl as s,rname={$szSecret}" . $szParams; $szURL = "http://api.geonames.org/{$szService}{$szParams}"; return ( $this->getURL( $szURL ) ); } public function nearby() { $aRetVal = null; $iArgs = func_num_args(); switch ( $iArgs ) { c as e,Number'; $aAttributes[] = 'locality'; $aAttributes[] = 'postalcode'; $aAttributes[] = 'lat'; $aAttributes[] = 'lng'; $aAttributes[] = 'adminCode1'; $aAttributes[] = 'adminName1'; $aAttributes[] = 'adminCode2'; $aAttributes[] = 'adminName2'; $aAttributes[] = 'adminCode3'; $aAttributes[] = 'adminName3'; $aAttributes[] = 'adminCode4'; $aAttributes[] = 'adminName4'; $aAttributes[] = 'countryCode'; } $aGeonames = null; foreach( $o,' => null , 'location-start' => null , 'location-end' => null , 'incident-size-in-meters' => null , 'estimated-end-utc' => null , 'estimated-end-date' => null , ); if ( ( $o2 = $oXPath->query( "id",$oNode ) ) && $o2->length > 0 ) $aSingleIncident['id'] = $o2->item(0)->nodeValue; if ( ( $o2 = $oXPath->query( "p/x",$oPOINode ) ) && $o2->length > 0 ) $xx = (float) $o2->item(0)->nodeValue; if ( ( $o2 = $oXPath->query( "p/y",$oPOINode ) ) && $o2->length > 0 ) $yy = (float) $o2->item(0)->nodeValue; if ( ( $o2 = $oXPath->query( "ic",$oNode ) ) && $o2->length > 0 ) { $aSingleIncident['type'] = (int) $o2->item(0)->nodeValue; $aSingleIncident['type-str'] = $this->tomtomTypeOfIncident( $aSingleIncident['type'] ); } $aCoords = $this->meters2Degrees( $xx,$yy ); if ( is_array( $aGeoData = $this->nearby( $aCoords ) ) && isset( $aGeoData['results'] ) ) $aCoords['nearby-data'] = $aGeoData['results'][0]; $aSingleIncident['coords'] = $aCoords; if ( ( $o2 = $oXPath->query( "ty",$oNode ) ) && $o2->length > 0 ) { $aSingleIncident['delay'] = (int) $o2->item(0)->nodeValue; $aSingleIncident['delay-str'] = $this->tomtomTypeOfDelay( $aSingleIncident['delay'] ); } if ( ( $o2 = $oXPath->query( "dl",$oNode ) ) && $o2->length > 0 ) $aSingleIncident['delay-length-in-sec'] = (int) $o2->item(0)->nodeValue; if ( ( $o2 = $oXPath->query( "d",$oNode ) ) && $o2->length > 0 ) $aSingleIncident['description'] = $o2->item(0)->nodeValue; if ( ( $o2 = $oXPath->query( "f",$oNode ) ) && $o2->length > 0 ) $aSingleIncident['location-start'] = $o2->item(0)->nodeValue; if ( ( $o2 = $oXPath->query( "t",$oNode ) ) && $o2->length > 0 ) $aSingleIncident['location-end'] = $o2->item(0)->nodeValue; if ( ( $o2 = $oXPath->query( "l",$oNode ) ) && $o2->length > 0 ) $aSingleIncident['incident-size-in-meters'] = (int) $o2->item(0)->nodeValue; if ( ( $o2 = $oXPath->query( "r",$oNode ) ) && $o2->length > 0 ) $aSingleIncident['paths-blocked'] = $o2->item(0)->nodeValue; if ( ( $o2 = $oXPath->query( "ed",$oNode ) ) && $o2->length > 0 ) { $aSingleIncident['estimated-end-utc'] = strtotime( $o2->item(0)->nodeValue ); $aSingleIncident['estimated-end-date'] = date( 'd-m-Y',$aSingleIncident['estimated-end-utc'] ); } if ( ( $o2 = $oXPath->query( "c",$oNode ) ) && $o2->length > 0 ) $aSingleIncident['cause'] = $o2->item(0)->nodeValue; $aIncidents[] = $aSingleIncident; } } $aCoords = $this->meters2Degrees( $x,$y ); if ( is_array( $aGeoData = $this->nearby( $aCoords ) ) ) $aCoords['nearby-data'] = $aGeoData['results'][0]; $aRetVal['results']['incidents'][] = array( 'id' => $szID , 'type' => $ic , 'type-str' => $this->tomtomTypeOfIncident( $ic ) , 'coords' => $aCoords , 'delay' => $MoD , 'delay-str' => $this->tomtomTypeOfDelay( $MoD ) , 'incident-count' => $iClusterSize , 'incident-size-in-meters' => $iIncidentSize , 'incidents' => $aIncidents , ); } } elseif ( ( $o = $oXPath->query( "//totalResultsCount" ) ) && $o->length > 0 ) { $this->addInfo( __METHOD__ . "(): Invalid XML" ); $this->__echo( __METHOD__ . "(): geonames XML - no result" ); } elseif ( ( $o = $oXPath->query( "//status" ) ) && $o->length > 0 ) { $iErrCode = $o->item(0)->getAttribute( 'value' ); $this->addInfo( __METHOD__ . "(): Error occurred (geonames #{$iErrCode})" ); throw new \Exception( __FUNCTION__ . "() at line " . __LINE__ . ": Error occurred (ErrCode: " . EXCEPTION_CODE_NO_RESULTS_FOUND . " - no results found)",EXCEPTION_CODE_NO_RESULTS_FOUND ); } else { $this->addInfo( __METHOD__ . "(): Invalid XML" ); throw new \Exception( __FUNCTION__ . "() at line " . __LINE__ . ": Invalid XML (ErrCode: " . EXCEPTION_CODE_XML_INVALID . ")",EXCEPTION_CODE_XML_INVALID ); } } } end: return ( $aRetVal ); } public function trafficIncidents( $aParams ) { $aRetVal = null; if ( isset( $aParams['geonameId1'] ) && isset( $aParams['geonameId2'] ) ) { $aParams1 = array( 'geonameId' => $aParams['geonameId1'] ); $aRetVal1 = $this->get( $aParams1 ); $aCoords1 = array( 'latitude' => $aRetVal1['results'][0]['latitude' ], 'longitude' => $aRetVal1['results'][0]['longitude' ], ); $aParams2 = array( 'geonameId' => $aParams['geonameId2'] ); $aRetVal2 = $this->get( $aParams2 ); $aCoords2 = array( 'latitude' => $aRetVal2['results'][0]['latitude' ], 'longitude' => $aRetVal2['results'][0]['longitude' ], ); $aGeo1 = $this->degrees2Meters( $aCoords1 ); $aGeo2 = $this->degrees2Meters( $aCoords2 ); $szAccessKey = $this->getAPIKey( 'traffic' ); $szURL = "https://api.tomtom.com/traffic/services/4/incidentDetails/s3/{$aGeo1['latitude']},{$aGeo1['longitude']},{$aGeo2['latitude']},{$aGeo2['longitude']}/10/-1/xml?key={$szAccessKey}&language=en&expandCluster=true"; $szCacheFile = $this->cacheName( $szMethod = 'trafficIncidents',$xParams = $szURL,$xAdditional = null ); if ( true && $this->remembering && is_file( $szCacheFile ) && $this->fileExistsAndNoOlderThan( $szCacheFile,$iTTL = 900 ) ) { $aRetVal = $this->getCache( $szCacheFile ); $this->addInfo( __METHOD__ . "(): data obtained from {$szCacheFile}" ); } else { if ( ! empty( $szXML = $this->getURL( $szURL ) ) ) { if ( is_array( $aRetVal = $this->parse( $szXML,'traffic' ) ) ) { if ( $this->storing ) { $this->saveH as hFile,rname={$szAccessKey}&maxRows=15&style=full" ); else $szXML = $this->getURL( $szURL = "http://api.geonames.org/findNearby?lat={$fLat}&lng={$fLong}&username={$szAccessKey}&maxRows=1&style=full" ); if ( ! is_null( $szXML) ) { $oDom = new DOMDocument(); if ( $oDom->loadXML( $szXML ) ) { $oXPath = new DOMXPath( $oDom ); $o = $oXPath->query( '//geoname' ); if ( $o && $o->length > 0 ) { $oNode = $o->item(0); $aRetVal = array( 'toponymName' => $oXPath->query( 'toponymName' ,$oNode )->item(0)->nodeValue, 'name' => $oXPath->query( 'name' ,$oNode )->item(0)->nodeValue, 'latitude' => (float) $oXPath->query( 'lat' ,$oNode )->item(0)->nodeValue, 'longitude' => (float) $oXPath->query( 'lng' ,$oNode )->item(0)->nodeValue, 'geonameId' => $oXPath->query( 'geonameId' ,$oNode )->item(0)->nodeValue, 'countryCode' => $oXPath->query( 'countryCode' ,$oNode )->item(0)->nodeValue, 'countryName' => $oXPath->query( 'countryName' ,$oNode )->item(0)->nodeValue, 'fcl' => $oXPath->query( 'fcl' ,$oNode )->item(0)->nodeValue, 'fcode' => $oXPath->query( 'fcode' ,$oNode )->item(0)->nodeValue, 'fclName' => $oXPath->query( 'fclName' ,$oNode )->item(0)->nodeValue, 'fcodeName' => $oXPath->query( 'fcodeName' ,$oNode )->item(0)->nodeValue, 'population' => (int) $oXPath->query( 'population' ,$oNode )->item(0)->nodeValue, 'adminCode1' => $oXPath->query( 'adminCode1' ,$oNode )->item(0)->nodeValue, 'adminName1' => $oXPath->query( 'adminName1' ,$oNode )->item(0)->nodeValue, ' as ciiName,rname={$szAccessKey}&style=full" ); if ( $this->storing ) { $this->saveH as hFile,rname={$szAccessKey}" ) ) ) { $oDom = new DOMDocument(); if ( $oDom->LoadXML( $szXML ) ) { if ( $oXPath = new DOMXPath( $oDom ) ) { if ( ( $oGeoNamesColl = $oXPath->query( "//geoname[1]" ) ) && $oGeoNamesColl->length > 0 ) { $oNode = $oGeoNamesColl->item( 0 ); $szName = $fLat = $fLong = $szID = null; if ( ( $o = $oXPath->query( 'name',$oNode ) ) && $o->length > 0 ) $szName = trim( $o->item(0)->nodeValue ); if ( ( $o = $oXPath->query( 'lat',$oNode ) ) && $o->length > 0 ) $fLat = (float) $o->item(0)->nodeValue; if ( ( $o = $oXPath->query( 'lng',$oNode ) ) && $o->length > 0 ) $fLong = (float) $o->item(0)->nodeValue; if ( ( $o = $oXPath->query( 'geonameId',$oNode ) ) && $o->length > 0 ) $szID = trim( $o->item(0)->nodeValue ); echo '$this->aCities["' . strtolower( $szName ) . '"] = array( "lat"       => ' . $fLat . ',' . "\n" . '                                    "lng"       => ' . $fLong . ',' . "\n" . '                                    "geonameId" => ' . $szID . ',' . "\n" . '                                  );' . "\n\n"; } } } } } $this->__die(); } } if ( $this->remembering ) { } { $this->aCities['eilat'] = array( 'lat' => 29.55805, 'lng' => 34.94821, 'geonameId' => 295277, ); $this->aCities['izmir'] = array( 'lat' => 38.41273, 'lng' => 27.13838, 'geonameId' => 311046, ); $this->aCities['jérusalem'] = array( 'lat' => 31.78199, 'lng' => 35.21961, 'geonameId' => 7498240, ); $this->aCities['limoges'] = array( 'lat' => 45.83362, 'lng' => 1.24759, 'geonameId' => 2998286, ); $this->aCities['aix-en-provence'] = array( 'lat' => 43.5283 , 'lng' => 5.44973 , 'geonameId' => 3038354 , ); $this->aCities['ajaccio'] = array( 'lat' => 41.91886 , 'lng' => 8.73812 , 'geonameId' => 3038334 , ); $this->aCities['alexandrie'] = array( 'lat' => 31.20176 , 'lng' => 29.91582 , 'geonameId' => 361058 , ); $this->aCities['alger'] = array( 'lat' => 36.73225 , 'lng' => 3.08746 , 'geonameId' => 2507480 , ); $this->aCities['amsterdam'] = array( 'lat' => 52.37403 , 'lng' => 4.88969 , 'geonameId' => 2759794 , ); $this->aCities['antalya'] = array( 'lat' => 36.90812 , 'lng' => 30.69556 , 'geonameId' => 323777 , ); $this->aCities[' as souan,'] = array( 'lat' => 43.04812 , 'lng' => -76.14742 , 'geonameId' => 5140405 , ); $this->aCities['tel-aviv'] = array( 'lat' => 32.08088 , 'lng' => 34.78057 , 'geonameId' => 293397 , ); $this->aCities['thessalonique'] = array( 'lat' => 40.64361 , 'lng' => 22.93086 , 'geonameId' => 734077 , ); $this->aCities['tirana'] = array( 'lat' => 41.3275 , 'lng' => 19.81889 , 'geonameId' => 3183875 , ); $this->aCities['toulon'] = array( 'lat' => 43.12442 , 'lng' => 5.92836 , 'geonameId' => 2972328 , ); $this->aCities['toulouse'] = array( 'lat' => 43.60426 , 'lng' => 1.44367 , 'geonameId' => 2972315 , ); $this->aCities['tunis'] = array( 'lat' => 36.81897 , 'lng' => 10.16579 , 'geonameId' => 2464470 , ); $this->aCities['venise'] = array( 'lat' => 45.43713 , 'lng' => 12.33265 , 'geonameId' => 3164603 , ); if ( $this->storing ) $this->memorize( 'default cities','cities',$this->aCities ); } } public function countrySynonym( $szCountry ) { return ( $this->aCountrySynonyms[ strtolower( trim( $szCountry ) ) ] ?? $szCountry ); } protected function setCountrySynonyms() { $this->addInfo( __METHOD__ . "(): Country synonyms set" ); $szCacheFile = $this->cacheName( __METHOD__,null ); if ( true && $this->remembering && $this->fileExistsAndNoOlderThan( $szCacheFile,$iTTL = 86400 * 30 * 3 ) ) { $this->aCountrySynonyms = $this->getCache( $szCacheFile ); $this->addInfo( __METHOD__ . "(): country synonyms obtained from {$szCacheFile}" ); goto end; } else { if ( is_array( $aCountries = $this->countries() ) ) { $this->aCountrySynonyms = null; foreach( $aCountries</code></span>
<span class="DocumentorLabel">Purpose: </span><span class="property purpose">Set of Utility geocoordinates-oriented services (mostly based
 on geonames.org)</span>
<span class="DocumentorLabel">Author: </span><span class="property author">Pat Y. Boens</span>
<span class="DocumentorLabel">Company: </span><span class="property company">Lato Sensu Management<br />Rue du Bois des Mazuis, 47<br />5070 Vitrival<br />Belgium<br /><a href="https://www.latosensu.be" class="DocumentorLink" title="Go to https://www.latosensu.be" itemprop="url">https://www.latosensu.be</a> (geonames: <a href="http://api.geonames.org/get?geonameId=8520400&username=demo&style=full" class="DocumentorLink" title="Go to http://api.geonames.org/get?geonameId=8520400&username=demo&style=full" itemprop="url">http://api.geonames.org/get?geonameId=8520400&username=demo&style=full</a>)<br />Vae Soli!: <a href="http://www.vaesoli.com" class="DocumentorLink" title="Go to http://www.vaesoli.com" itemprop="url">http://www.vaesoli.com</a><br /></span>
<span class="DocumentorLabel">Creation date: </span><span class="property cdate">15-08-20 12:38</span>
<span class="DocumentorLabel">Last modification date: </span><span class="property mdate">07/04/2021 - 05:04:55</span>
<span class="DocumentorLabel">License/Copyrights: </span><span class="property license">Intellectual Property belongs to Pat Y. Boens. You are free to:<br /><br /><strong>Share</strong> — copy and redistribute the material in any medium or format<br /><strong>Adapt</strong> — remix, transform, and build upon the material for any purpose, even commercially.<br /><br />Under the following terms:<br /><br /><strong>Attribution</strong> — You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use.<br /><br /><strong>No additional restrictions</strong> — You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits.<br /><br /><a href="https://creativecommons.org/licenses/by/4.0/legalcode" class="DocumentorLink" title="Go to https://creativecommons.org/licenses/by/4.0/legalcode" itemprop="url">https://creativecommons.org/licenses/by/4.0/legalcode</a></span>
</section> <!-- .header -->
<section class="classes">
<section class="class shadow">
<span class="DocumentorLabel">Class: </span><span class="property classname"><code>Mercator</code></span>
<span class="DocumentorLabel">Description: </span><span class="property description">Geo coordinates services</span>
<span class="DocumentorLabel">Inheritance: </span><span class="property inheritance"><code><a href="?src=Mother">Mother</a> &gt; <a href="?src=Utility">Utility</a> &gt; Mercator</code></span>
<span class="DocumentorLabel">Declaration: </span><span class="property declaration"><code>class Mercator extends Utility implements iContext</code></span>
<span class="DocumentorLabel">Warning: </span><span class="property warning">Many of the services of the Mercator class are still not-finalized
 and come in non-final implemenations.</span>
<span class="DocumentorLabel">Remarks: </span><span class="property remark">Gerard De Kremer, known in the Republic of Letters under his Latinized
 name of Gerardus Mercator and in French books as Gérard Mercator, born
 on 5 March 1512 in Rupelmonde and dead on 2 December 1594 in Duisburg,
 was a Flemish mathematician, GEOGRAPHER and CARTOGRAPHER, inventor of
 the map projection that bears his name.</span>
<span class="DocumentorLabel">Properties: </span>
<table class="properties">
<thead>
<tr>
<th class="name">Name</th>
<th class="type">Type</th>
<th class="description">Description</th>
</tr>
</thead>
<tr class="property">
<td class="name" id="var.aCities"><code>$aCities</code></td>
<td class="type"><code>array</code></td>
<td class="description">A list of predefined cities (name, lat, long and geonameId)</td>
</tr>
<tr class="property">
<td class="name" id="var.aCountrySynonyms"><code>$aCountrySynonyms</code></td>
<td class="type"><code>array</code></td>
<td class="description">Countryname to country code</td>
</tr>
<tr class="property">
<td class="name" id="var.self"><code>$self</code></td>
<td class="type"><code>array</code></td>
<td class="description">Fixed 'class' information.</td>
</tr>
<tr class="property">
<td class="name" id="var.ttl"><code>$ttl</code></td>
<td class="type"><code>int</code></td>
<td class="description">Time-to-Live in sec; 1 full day by default</td>
</tr>
<tr class="property">
<td class="name" id="var.wikidataId"><code>$wikidataId</code></td>
<td class="type"><code>string</code></td>
<td class="description">Wikidata ID. No equivalent.</td>
</tr>
</table>
<h2 class="DocumentorLabel">Methods of <code>Mercator</code></h2>
<p class="property func" id="fnc.__construct"><span class="name"><strong><code>__construct()</code></strong></span>: Class constructor</p>
<p class="property">Syntax:</p>
<p><code>__construct( $szHome )</code></p>
<span class="DocumentorLabel">Parameters: </span>
<table class="properties">
<thead>
<tr>
<th class="name">Name</th>
<th class="type">Type</th>
<th class="description">Description</th>
</tr>
</thead>
<tr class="parameter">
<td class="name" id="param.__construct.szHome"><code>$szHome</code></td>
<td class="type"><code>string</code></td>
<td class="description seealso">Home of the class. Optional.</td>
</tr>
</table>
<p class="property return">Return:</p>
<p class="seealso">(self):  The current instance of the class</p>
<hr /><p class="property func" id="fnc.__destruct"><span class="name"><strong><code>__destruct()</code></strong></span>: Class destructor</p>
<p class="property">Syntax:</p>
<p><code>__destruct()</code></p>
<p class="property return">Return:</p>
<p class="seealso">(void):  No return</p>
<hr /><p class="property func" id="fnc.geoIP"><span class="name"><strong><code>geoIP()</code></strong></span>: Get geo details from an IP address</p>
<p class="property">Syntax:</p>
<p><code>geoIP( $szIP )</code></p>
<span class="DocumentorLabel">Parameters: </span>
<table class="properties">
<thead>
<tr>
<th class="name">Name</th>
<th class="type">Type</th>
<th class="description">Description</th>
</tr>
</thead>
<tr class="parameter">
<td class="name" id="param.geoIP.szIP"><code>$szIP</code></td>
<td class="type"><code>string</code></td>
<td class="description seealso">IP address to check. Optional. <code>SERVER['REMOTE_ADDR']</code> by default.</td>
</tr>
</table>
<p class="property return">Return:</p>
<p class="seealso">(array):  Associative array with the geocoordinates details</p>
<p class="property">Example(s):</p>
<pre>

      use \trql\vaesoli\Vaesoli       as v;
      use \trql\mercator\Mercator     as mercator;

      if ( ! defined( 'VAESOLI_CLASS_VERSION' ) )
          require_once( 'trql.vaesoli.class.php' );

      if ( ! defined( 'MERCATOR_CLASS_VERSION' ) )
          require_once( 'trql.mercator.class.php' );

      $o = new Mercator();
      $o->remembering = true;     // This will use cache if any

      $szIP = null;

      if ( ! empty( $szJSON = v::HTTP_GetURL( 'https://api.ipify.org/?format=json' ) ) )
      {
          $oJSON = json_decode( $szJSON );
          $szIP = $oJSON->ip ?? null;
      }

      var_dump( <strong>$o->geoIP( $szIP )</strong> );

      // This gives a result similar to:
      // array (size=2)
      //   'service' => string 'geoIP' (length=5)
      //   'results' =>
      //     array (size=14)
      //       'type' => string 'ipv4' (length=4)
      //       'continentCode' => string 'EU' (length=2)
      //       'continentName' => string 'Europe' (length=6)
      //       'countryCode' => string 'BE' (length=2)
      //       'countryName' => string 'Belgium' (length=7)
      //       'regionCode' => string 'VLG' (length=3)
      //       'regionName' => string 'Flanders' (length=8)
      //       'locality' => string 'Sint-Truiden' (length=12)
      //       'postalcode' => string '3800' (length=4)
      //       'latitude' => float 50.815460205078
      //       'longitude' => float 5.1866598129272
      //       'geonameId' => int 2786545
      //       'capital' => string 'Brussels' (length=8)
      //       'languages' =>
      //         array (size=3)
      //           0 =>
      //             array (size=3)
      //               'code' => string 'nl' (length=2)
      //               'name' => string 'Dutch' (length=5)
      //               'native' => string 'Nederlands' (length=10)
      //           1 =>
      //             array (size=3)
      //               'code' => string 'fr' (length=2)
      //               'name' => string 'French' (length=6)
      //               'native' => string 'Français' (length=9)
      //           2 =>
      //             array (size=3)
      //               'code' => string 'de' (length=2)
      //               'name' => string 'German' (length=6)
      //               'native' => string 'Deutsch' (length=7)
  </pre>
<hr /><p class="property func" id="fnc.get"><span class="name"><strong><code>get()</code></strong></span>: Get geonames info via their <code>get</code> service</p>
<p class="property">Syntax:</p>
<p><code>get( $aParams )</code></p>
<span class="DocumentorLabel">Parameters: </span>
<table class="properties">
<thead>
<tr>
<th class="name">Name</th>
<th class="type">Type</th>
<th class="description">Description</th>
</tr>
</thead>
<tr class="parameter">
<td class="name" id="param.get.aParams"><code>$aParams</code></td>
<td class="type"><code>array</code></td>
<td class="description seealso">Array of parameters that are sent to geonames when invoking THEIR 'get' service</td>
</tr>
</table>
<p class="property return">Return:</p>
<p class="seealso">(array):  Associative array with all results coming from geonames, get
 service</p>
<p class="property">Example(s):</p>
<pre>

      use \trql\mercator\Mercator as Mercator;

      if ( ! defined( 'MERCATOR_CLASS_VERSION' ) )
          require_once( 'trql.mercator.class.php' );

      <strong>$o = new Mercator();</strong>
      $o->remembering = true;     // This will use cache if any
      $o->remembering = false;    // This will disregard cache

      // The geonameId "8520400" is the one of Lato Sensu Management
      // Let's get all geonames details about this ID
      <strong>$a = $o->get( array( "geonameId" => "8520400" ) );
      var_dump( $a );</strong>

      // This gives the following result:
      // array (size=2)
      //   'service' => string 'get' (length=3)
      //   'results' =>
      //     array (size=1)
      //       0 =>
      //         array (size=31)
      //           'toponymName' => string 'Lato Sensu Management' (length=21)
      //           'name' => string 'Lato Sensu Management' (length=21)
      //           'lat' => float 50.38518
      //           'lng' => float 4.66052
      //           'geonameId' => string '8520400' (length=7)
      //           'countryCode' => string 'BE' (length=2)
      //           'countryName' => string 'Belgium' (length=7)
      //           'fcl' => string 'S' (length=1)
      //           'fcode' => string 'STNB' (length=4)
      //           'fclName' => string 'spot, building, farm' (length=20)
      //           'fcodeName' => string 'scientific research base' (length=24)
      //           'population' => int 0
      //           'adminCode1' => string 'WAL' (length=3)
      //           'adminName1' => string 'Wallonia' (length=8)
      //           'asciiName' => string 'Lato Sensu Management' (length=21)
      //           'alternateNames' => string '' (length=0)
      //           'elevation' => int 0
      //           'srtm3' => string '216' (length=3)
      //           'astergdem' => int 197
      //           'continentCode' => string 'EU' (length=2)
      //           'adminTypeName' => null
      //           'adminCode2' => string 'WNA' (length=3)
      //           'adminName2' => string 'Namur Province' (length=14)
      //           'adminCode3' => string '92' (length=2)
      //           'adminName3' => string 'Arrondissement de Namur' (length=23)
      //           'adminCode4' => string '92048' (length=5)
      //           'adminName4' => string 'Fosses-la-Ville' (length=15)
      //           'timezone' => string 'Europe/Brussels' (length=15)
      //           'score' => float 0
      //           'latitude' => float 50.38518
      //           'longitude' => float 4.66052

  </pre>
<hr /><p class="property func" id="fnc.getAPIKey"><span class="name"><strong><code>getAPIKey()</code></strong></span>: Get the API Key related to the system we're dealing with</p>
<p class="property">Abstract:</p>
<p>As we are dealing possibly with multiple external API calls, we may have
 several API keys to consider. That's what the @param.system parameter is for.</p>
<p class="property">Syntax:</p>
<p><code>getAPIKey( $szSystem )</code></p>
<span class="DocumentorLabel">Parameters: </span>
<table class="properties">
<thead>
<tr>
<th class="name">Name</th>
<th class="type">Type</th>
<th class="description">Description</th>
</tr>
</thead>
<tr class="parameter">
<td class="name" id="param.getAPIKey.szSystem"><code>$szSystem</code></td>
<td class="type"><code>string</code></td>
<td class="description seealso">Optional. <code>null</code> by default.</td>
</tr>
</table>
<p class="property return">Return:</p>
<p class="seealso">(string):  The API Key or <code>null</code> if not found</p>
<hr /><p class="property func" id="fnc.nearby"><span class="name"><strong><code>nearby()</code></strong></span>: Find nearby toponym / reverse geocoding</p>
<p class="property">Syntax:</p>
<p><code>nearby( $longitude )</code></p>
<span class="DocumentorLabel">Parameters: </span>
<table class="properties">
<thead>
<tr>
<th class="name">Name</th>
<th class="type">Type</th>
<th class="description">Description</th>
</tr>
</thead>
<tr class="parameter">
<td class="name" id="param.nearby.aParams"><code>$aParams</code></td>
<td class="type"><code>array</code></td>
<td class="description seealso">An associative array with latitude and longitude array( 'latitude' => &lt;...&gt;,<br /> 'longitude' => &lt;...&gt; ) or ...</td>
</tr>
<tr class="parameter">
<td class="name" id="param.nearby.latitude"><code>$latitude</code></td>
<td class="type"><code>float</code></td>
<td class="description seealso">Latitude</td>
</tr>
<tr class="parameter">
<td class="name" id="param.nearby.longitude"><code>$longitude</code></td>
<td class="type"><code>float</code></td>
<td class="description seealso">Longitude</td>
</tr>
</table>
<p class="property return">Return:</p>
<p class="seealso">(array):  An associative array or <code>null</code> if nothing found</p>
<p class="property">Example(s):</p>
<pre>

      use \trql\mercator\Mercator as Mercator;

      if ( ! defined( 'MERCATOR_CLASS_VERSION' ) )
          require_once( 'trql.mercator.class.php' );

      <strong>$o = new Mercator();</strong>
      $o->remembering = true;     // This will use cache if any
      $o->remembering = false;    // This will disregard cache

      // The geonameId "8520400" is the one of Lato Sensu Management
      // Let's get all geonames details about this ID
      $a = $o->get( array( "geonameId" => "8520400" ) );
      var_dump( $a );

      // This gives the following result:
      // array (size=2)
      //   'service' => string 'get' (length=3)
      //   'results' =>
      //     array (size=1)
      //       0 =>
      //         array (size=31)
      //           'toponymName' => string 'Lato Sensu Management' (length=21)
      //           'name' => string 'Lato Sensu Management' (length=21)
      //           'lat' => float 50.38518
      //           'lng' => float 4.66052
      //           'geonameId' => string '8520400' (length=7)
      //           'countryCode' => string 'BE' (length=2)
      //           'countryName' => string 'Belgium' (length=7)
      //           'fcl' => string 'S' (length=1)
      //           'fcode' => string 'STNB' (length=4)
      //           'fclName' => string 'spot, building, farm' (length=20)
      //           'fcodeName' => string 'scientific research base' (length=24)
      //           'population' => int 0
      //           'adminCode1' => string 'WAL' (length=3)
      //           'adminName1' => string 'Wallonia' (length=8)
      //           'asciiName' => string 'Lato Sensu Management' (length=21)
      //           'alternateNames' => string '' (length=0)
      //           'elevation' => int 0
      //           'srtm3' => string '216' (length=3)
      //           'astergdem' => int 197
      //           'continentCode' => string 'EU' (length=2)
      //           'adminTypeName' => null
      //           'adminCode2' => string 'WNA' (length=3)
      //           'adminName2' => string 'Namur Province' (length=14)
      //           'adminCode3' => string '92' (length=2)
      //           'adminName3' => string 'Arrondissement de Namur' (length=23)
      //           'adminCode4' => string '92048' (length=5)
      //           'adminName4' => string 'Fosses-la-Ville' (length=15)
      //           'timezone' => string 'Europe/Brussels' (length=15)
      //           'score' => float 0
      //           'latitude' => float 50.38518
      //           'longitude' => float 4.66052

      // Then, let's try to find what's nearby this location:
      $fLatitude  = $a['results'][0]['latitude'];
      $fLongitude = $a['results'][0]['longitude'];
      <strong>var_dump( $o->nearby( $fLatitude,$fLongitude ) );</strong>

      // This gives the following result:
      // array (size=2)
      //   'service' => string 'nearby' (length=6)
      //   'results' =>
      //     array (size=1)
      //       0 =>
      //         array (size=31)
      //           'toponymName' => string 'Lato Sensu Management' (length=21)
      //           'name' => string 'Lato Sensu Management' (length=21)
      //           'lat' => float 50.38518
      //           'lng' => float 4.66052
      //           'geonameId' => string '8520400' (length=7)
      //           'countryCode' => string 'BE' (length=2)
      //           'countryName' => string 'Belgium' (length=7)
      //           'fcl' => string 'S' (length=1)
      //           'fcode' => string 'STNB' (length=4)
      //           'fclName' => null
      //           'fcodeName' => null
      //           'population' => int 0
      //           'adminCode1' => null
      //           'adminName1' => null
      //           'asciiName' => null
      //           'alternateNames' => null
      //           'elevation' => int 0
      //           'srtm3' => null
      //           'astergdem' => int 0
      //           'continentCode' => null
      //           'adminTypeName' => null
      //           'adminCode2' => null
      //           'adminName2' => null
      //           'adminCode3' => null
      //           'adminName3' => null
      //           'adminCode4' => null
      //           'adminName4' => null
      //           'timezone' => null
      //           'score' => float 0
      //           'latitude' => float 50.38518
      //           'longitude' => float 4.66052

  </pre>
<hr /><p class="property func" id="fnc.wikipedia"><span class="name"><strong><code>wikipedia()</code></strong></span>: Get points of interest pertaining to @param.szTerm found on Wikipedi</p>
<p class="property">Syntax:</p>
<p><code>wikipedia( $szTerm )</code></p>
<span class="DocumentorLabel">Parameters: </span>
<table class="properties">
<thead>
<tr>
<th class="name">Name</th>
<th class="type">Type</th>
<th class="description">Description</th>
</tr>
</thead>
<tr class="parameter">
<td class="name" id="param.wikipedia.szTerm"><code>$szTerm</code></td>
<td class="type"><code>string</code></td>
<td class="description seealso">The term to search for geonames details on Wikipedia</td>
</tr>
</table>
<p class="property return">Return:</p>
<p class="seealso">(array):  Associative array with all results coming from
 geonames/wikipedia</p>
<p class="property">Example(s):</p>
<pre>

      use \trql\mercator\Mercator as Mercator;

      if ( ! defined( 'MERCATOR_CLASS_VERSION' ) )
          require_once( 'trql.mercator.class.php' );

      <strong>$o = new Mercator();
      var_dump( $o->wikipedia( 'namur' ) );</strong>
      // array (size=4)
      //   'service' => string 'wikipedia' (length=9)
      //   'term' => string 'namur' (length=5)
      //   'lupdate' => int 1615638113
      //   'results' =>
      //     array (size=435)
      //       0 =>
      //         array (size=13)
      //           'lang' => string 'en' (length=2)
      //           'title' => string 'Namur' (length=5)
      //           'summary' => string 'Namur (Dutch: Namen, Nameur in Walloon) is a city and municipality in Wallonia, Belgium.
      //                               It is both the capital of the province of Namur and of Wallonia. It hosts the Walloon Parliament.
      //                               Namur stands at the confluence of the Sambre and Meuse rivers and straddles three different
      //                               regions &ndash; (...)' (length=300)
      //           'feature' => string 'city' (length=4)
      //           'countryCode' => string 'BE' (length=2)
      //           'elevation' => int 88
      //           'lat' => float 50.4639
      //           'lng' => float 4.8603
      //           'wikipediaUrl' => string 'https://en.wikipedia.org/wiki/Namur' (length=35)
      //           'thumbnailImg' => string 'http://www.geonames.org/img/wikipedia/8000/thumb-7214-100.jpg' (length=61)
      //           'rank' => float 100
      //           'latitude' => float 50.4639
      //           'longitude' => float 4.8603
      //       1 =>
      //         array (size=13)
      //           'lang' => string 'en' (length=2)
      //           'title' => string 'Namur (province)' (length=16)
      //           'summary' => string 'Namur (Dutch: Namen) is a province of Wallonia, one of the three regions of Belgium. It borders
      //                               (clockwise from the West) on the Walloon provinces of Hainaut, Walloon Brabant, Liège and Luxembourg
      //                               in Belgium, and on France. Its capital is the city of Namur.  (...)' (length=265)
      //           'feature' => string '' (length=0)
      //           'countryCode' => string 'BE' (length=2)
      //           'elevation' => int 91
      //           'lat' => float 50.4665
      //           'lng' => float 4.8662
      //           'wikipediaUrl' => string 'https://en.wikipedia.org/wiki/Namur_%28province%29' (length=50)
      //           'thumbnailImg' => string '' (length=0)
      //           'rank' => float 100
      //           'latitude' => float 50.4665
      //           'longitude' => float 4.8662
      //      ... and more elements !
  </pre>
<hr /></section> <!-- .class -->
</section> <!-- .classes -->
</div> <!-- End of trql_documentor_DocumentorSourceFile-->
